{% extends 'base.html' %}
{% load i18n %}

    {% block additional-headers %}
        <style >
        .data-table-container table {
            clear: both;
            display: table !important;
            overflow-x: auto;
            width: 98% !important;
        }

        .highlight { background-color: #D9EDF7; }

        .table th, .table td {
            border: 1px solid #dddddd !important;
        }
    </style>
    {% endblock %}
    
    {% block additional-javascript %}
    <script type="text/javascript" src="/static/js/organization_access.js"></script>

    <script type="text/javascript">
        $('.delete-user-item').on('click', function(e) {
            var criteria_id = $(this).attr("data-href");
            console.log(criteria_id);
            $('.btn-ok').attr("href",criteria_id);
        });
    </script>
    {% endblock %}
    


{% block content %}
    <section id="data-view">
        {% if org_del_message %} 
            <div class="alert alert-danger" role="alert">
                {{org_del_message}}
            </div>    
            <div class="alert alert-danger" role="alert">
                {{org_del_message2}}
            </div>    
            
        {% endif %}
        {% if message %}

            {% if alert == "alert-success" %}
                <div id="message" class="alert alert-success" role="alert">
            {% elif alert == "alert-warning" %}
                <div id="message" class="alert alert-warning" role="alert">
            {% else %}                    
                <div id="message" >
            {% endif %}    
                <span id="message" class="glyphicon glyphicon-exclamation-sign" aria-hidden="true"></span>
              {{ message }}
            </div>
        {% endif %}
        <h1>Organization Management</h1>
        <form action="/usermodule/add-organization">
            <input type="submit" class="btn btn-success" value="Add Organization">
        </form>
        <br>
        <!-- <a href="/usermodule/organization-mapping">Add a mapping</a><br /> -->
        <div id='tables' style="display:table !important;" class="data-table-container table">
            <table id="organizations-table" border="1" id="organization-list" class="table">
              <tr>
                <th style="text-align:center" >Organization</th>
                <th style="text-align:center" >Parent</th>
                <th style="text-align:center" >Edit</th>
                <th style="text-align:center" >Delete</th>
              </tr>

            {% for organization in all_organizations %}

              <tr>
                <td style="text-align:center" ><a class="organization" org-name="{{ organization.oraganization }}" data-id="organization-{{ organization.id }}" href="#">{{ organization }}</a></td>
                <td style="text-align:center" >{{ organization.parent_organization }}</a></td>
                <td style="text-align:center" ><a href="/usermodule/edit-organization/{{ organization.id }}"><i class="fa fa-pencil-square-o"></i></a></td>
                <!-- <td><a href="/usermodule/organization-delete/{{ organization.id}}"><i class="fa fa-trash-o"></a></td> -->
                <td style="text-align:center" ><a href="#" data-href="/usermodule/organization-delete/{{ organization.id}}" data-toggle="modal" data-target="#confirm-delete" class="delete-user-item"><i class="fa fa-trash-o"></a></td>

              </tr>
            {% endfor %}
            </table>
        </div>
        
        <!-- Delete Confirmation Modal -->
        <div class="modal fade" id="confirm-delete" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
            <div class="modal-dialog">
                <div class="modal-content">
                
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myModalLabel">Confirm Delete</h4>
                    </div>
                
                    <div class="modal-body">
                        <p>You are about to delete a Organization or it's, access mapping. This procedure is irreversible.</p>
                        <p>Do you want to proceed?</p>
                        <p class="debug-url"></p>
                    </div>
                    
                    <div class="modal-footer">
                        <button type="button" class="btn btn-default" data-dismiss="modal">Cancel</button>
                        <a href="#" class="btn btn-danger btn-ok">Delete</a>
                    </div>
                </div>
            </div>
        </div>

    </section>
{% endblock %}
